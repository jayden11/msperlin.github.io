<h2>Motivation</h2>

<p>One of the great things of working in finance is that financial datasets are freely available from sources such as Google and Yahoo Finance. This is an excelent feature for building up to date content for classes and conducting academic research. </p>

<p>In the past I have used function GetSymbols from the CRAN package <a href="https://cran.r-project.org/package=quantmod">quantmod</a> in order to download end of day trade data for several stocks in the financial market. The problem in using GetSymbols is that it was not designed to take into consideration the aggregation of financial data for several tickers. In the usage of GetSymbols, each stock will have its own <code>xts</code> object with different column names and this makes it troublesome to store data from several tickers in a single dataframe in the long format. Nonetheless, if you are using dplyr and ggplot2 to process and plot data, the long format is expected.</p>

<p>The package BatchGetSymbols is my solution to this problem. Based on a list of tickers and a time period, the function will download the data by automatically choosing the correct source, yahoo or google, and output two dataframes: a single dataframe with all the information for the stocks in the list and a dataframe with a report of the download process. The user can also set a benchmark ticker in order to compare dates and eliminate assets with a low number of observations from the resulting dataframe.</p>

<h2>A simple example</h2>

<p>As a simple exercise, let&#39;s download data for three stocks, facebook (FB), 3M (MMM), PETR4.SA (PETROBRAS) and abcdef, a ticker I just made up. We will use the last 150 days as the time period. This example will show the simple interface of the package and how it handles invalid tickers.</p>

<pre><code class="r">library(BatchGetSymbols)
</code></pre>

<pre><code>## Loading required package: rvest
</code></pre>

<pre><code>## Loading required package: xml2
</code></pre>

<pre><code>## 
## Thank you for using BatchGetSymbols! If applicable, please use the following citation in your research report. Thanks! 
## 
## APA:
##  Perlin, M. (2016) BatchGetSymbols: Downloads and Organizes Financial Data for Multiple Tickers. CRAN Package, Available in https://CRAN.R-project.org/package=BatchGetSymbols. 
## 
## BIBTEX:
##  @misc{perlin2016batchgetsymbols,
##   title = {BatchGetSymbols: Downloads and Organizes Financial Data for Multiple Tickers},
##   author = {Marcelo Perlin},
##   year = {2016},
##   journal = {CRAN Package},
##   url = {https://CRAN.R-project.org/package=BatchGetSymbols}
## }
## }
</code></pre>

<pre><code class="r">first.date &lt;- Sys.Date()-150
last.date &lt;- Sys.Date()

tickers &lt;- c(&#39;FB&#39;,&#39;NYSE:MMM&#39;,&#39;PETR4.SA&#39;,&#39;abcdef&#39;)

l.out &lt;- BatchGetSymbols(tickers = tickers,
                         first.date = first.date,
                         last.date = last.date)
</code></pre>

<pre><code>## 
## Running BatchGetSymbols for:
##    tickers = FB, NYSE:MMM, PETR4.SA, abcdef
##    Downloading data for benchmark ticker
## Downloading Data for FB from yahoo (1|4) - Good stuff!
## Downloading Data for NYSE:MMM from google (2|4) - Got it!
## Downloading Data for PETR4.SA from yahoo (3|4) - Got it!
## Downloading Data for abcdef from yahoo (4|4) - Error in download..
</code></pre>

<p>After downloading the data, we can check the success of the process for each ticker. Notice that the last ticker does not exist in yahoo finance or google and therefore results in an error. All information regarding the download process is provided in the dataframe df.control:</p>

<pre><code class="r">print(l.out$df.control)
</code></pre>

<pre><code>##     ticker    src download.status total.obs perc.benchmark.dates
## 1       FB  yahoo              OK       103                    1
## 2 NYSE:MMM google              OK       103                    1
## 3 PETR4.SA  yahoo              OK       106                    1
## 4   abcdef  yahoo          NOT OK         0                    0
##   threshold.decision
## 1               KEEP
## 2               KEEP
## 3               KEEP
## 4                OUT
</code></pre>

<p>Moreover, we can plot the daily closing prices using ggplot2:</p>

<pre><code class="r">library(ggplot2)
</code></pre>

<pre><code>## Use suppressPackageStartupMessages() to eliminate package startup
## messages.
</code></pre>

<pre><code class="r">p &lt;- ggplot(l.out$df.tickers, aes(x = ref.date, y = price.close))
p &lt;- p + geom_line()
p &lt;- p + facet_wrap(~ticker, scales = &#39;free_y&#39;) 
print(p)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot.prices"/></p>

<h2>Downloading data for all tickers in the SP500 index</h2>

<p>A more advanced example would be to download data for all stocks in the current composition of the SP500 stock index. The package also includes a function that downloads the current composition of the SP500 index from the internet. By using this function along with BatchGetSymbols, we can easily import end-of-day data for all assets in the SP500 index. </p>

<p>Notice the following code, where we download data for the SP500 stocks for the last year. The code is not executed in this example given its time duration, but you can just copy and paste on its own R script in order to check the results. In my computer it takes around 5 minutes to download the whole dataset.</p>

<pre><code class="r">library(BatchGetSymbols)

first.date &lt;- Sys.Date()-365
last.date &lt;- Sys.Date()

df.SP500 &lt;- GetSP500Stocks()
tickers &lt;- df.SP500$tickers

l.out &lt;- BatchGetSymbols(tickers = tickers,
                         first.date = first.date,
                         last.date = last.date)

print(l.out$df.control)
print(l.out$df.tickers)
</code></pre>

